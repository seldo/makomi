/**
 * jCanvas v13.07.16
 * Copyright 2013 Caleb Evans
 * Released under the MIT license
 */(function(e,t,n,r,i,s,o,u,a){function Nn(e){var t=this;an(t,e);return t}function Cn(e){e?an(Nn.prototype,e):Cn.prefs=Nn.prototype=an({},un);return this}function kn(e){return ln(e)==="string"}function Ln(e){return e&&e[A]?e[A]("2d"):u}function An(e){e=an({},e);e.masks=e.masks[vt](0);return e}function On(e,t){e.save();t[O].push(An(t[d]))}function Mn(e,t){if(t[O][f]===0)t[d]=An(Sn);else{e[at]();t[d]=t[O].pop()}}function _n(e,t,n){cn(n[b])?t[b]=n[b][y](e,n):t[b]=n[b];cn(n[T])?t[T]=n[T][y](e,n):t[T]=n[T];t.lineWidth=n[pt];if(n.rounded)t.lineCap=t.lineJoin="round";else{t.lineCap=n.strokeCap;t.lineJoin=n.strokeJoin;t.miterLimit=n.miterLimit}t.shadowOffsetX=n.shadowX;t.shadowOffsetY=n.shadowY;t[yt]=n[yt];t[v]=n[v];t.globalAlpha=n.opacity;t.globalCompositeOperation=n.compositing;n[Pt]&&(t.webkitImageSmoothingEnabled=t.mozImageSmoothingEnabled=n[Pt])}function Dn(e,t,n){if(n.mask){n[mt]&&On(e,t);e.clip();t[d].masks.push(n._args)}}function Pn(e,t){t._transformed&&e[at]()}function Hn(e,t,n){var r;n[bt]&&t[U]();if(n.shadowStroke&&n[pt]!==0){t.stroke();t.fill();t[v]=p;t[yt]=0;t.stroke()}else{t.fill();n[b]!==p&&(t[v]=p);n[pt]!==0&&t.stroke()}n[bt]||t[U]();Pn(t,n);if(n.mask){r=qn(e);Dn(t,r,n)}}function Bn(e,t,n){t[J]=t[Nt]?pn/180:1;e[S](t.x,t.y);e[ot](t[ot]*t[J]);e[S](-t.x,-t.y);n[ot]+=t[ot]*t[J]}function jn(e,t,n){t.scale!==1&&(t[st]=t[ut]=t.scale);e[S](t.x,t.y);e.scale(t[st],t[ut]);e[S](-t.x,-t.y);n[st]*=t[st];n[ut]*=t[ut]}function Fn(e,t,n){t[S]&&(t[F]=t[j]=t[S]);e[S](t[F],t[j]);n[F]+=t[F];n[j]+=t[j]}function In(e,t,n,r){t[J]=t[Nt]?pn/180:1;t._transformed=s;e.save();r===a&&(r=n);if(!t.fromCenter&&!t._centered){t.x+=n/2;t.y+=r/2;t._centered=s}t[ot]&&Bn(e,t,{});(t.scale!==1||t[st]!==1||t[ut]!==1)&&jn(e,t,{});(t[S]||t[F]||t[j])&&Fn(e,t,{})}function qn(t){var n;if(wn._canvas===t&&wn._data)n=wn._data;else{n=e.data(t,it);if(!n){n={canvas:t,layers:[],layer:{names:{},groups:{}},intersecting:[],drag:{},event:{type:u,x:u,y:u},events:{},transforms:An(Sn),savedTransforms:[],animating:o,animated:u,pixelRatio:1,scaled:!1};e.data(t,it,n)}wn._canvas=t;wn._data=n}return n}function Rn(e,t,n){var r;for(r in Cn[D])Cn[D][qt](r)&&Un(e,t,n,r)}function Un(e,t,n,r){if(n[r]){r=er(r);Cn[D][r](e,t);n[m]=s}}function zn(e,t,n){var r,i,o;if(n[Qt]||n[L]||n[xt]){r=[R,_,Y];for(o=0;o<r[f];o+=1){i=er(r[o]);Cn[D][i](e,t)}if(!t[D].mouseoutdrag){e.bind("mouseout.jCanvas",function(){var n=t.drag[c];if(n){t.drag={};n.dragcancel&&n.dragcancel[y](e[0],n);e[B]()}});t[D].mouseoutdrag=s}n[m]=s}}function Wn(e,t,n,r){var i=t[c].names;r?r[tt]!==a&&kn(n[tt])&&n[I]!==r[I]&&delete i[n[tt]]:r=n;kn(r[tt])&&(i[r[tt]]=n)}function Xn(e,t,n,r){var i=t[c][lt],s,o,u;if(!r)r=n;else if(r[I]!==a&&kn(n[I])&&n[I]!==r[I]){s=i[n[I]];if(s){for(u=0;u<s[f];u+=1)if(s[u]===n){o=u;s[g](u,1);break}s[f]===0&&delete i[n[I]]}}if(kn(r[I])){s=i[r[I]];if(!s){s=i[r[I]]=[];s[tt]=r[I]}o===a&&(o=s[f]);s[g](o,0,n)}}function Vn(e,t,n,r){if(n&&n[C]&&n[P]){r?n._next=r:n._next=u;n[P][y](e,n)}}function $n(t,n,r,i){var o,u,l=r,h;n._args=r;n.canvas=t;n[Qt]&&(n[c]=s);i?n[P]=i:n.method?n[P]=e.fn[n.method]:n.type?n[P]=e.fn[bn[n.type]]:n[P]=function(){};if(n[c]&&!n._layer){o=e(t);u=o[x]();h=qn(t);l=new Nn(n);Wn(o,h,l);Xn(o,h,l);Rn(o,h,l);zn(o,h,l);n[m]=l[m];l[c]=s;l._layer=s;l[H]===a&&(l[H]=u[f]);u[g](l[H],0,l)}return l}function Jn(e){var t;for(t=0;t<xn[f];t+=1)e[xn[t]]=e["_"+xn[t]]}function Kn(e,t){var n;for(n=0;n<xn[f];n+=1){e["_"+xn[n]]=e[xn[n]];Tn[xn[n]]=1;t&&delete e[xn[n]]}}function Qn(e,t,n){var r;for(r in n)n[qt](r)&&cn(n[r])&&(n[r]=n[r][y](e,t,r));return n}function Gn(n){var r,s,o=[],u=1;if(n[Ut](/^#?\w+$/gi)){n===p&&(n="rgba(0,0,0,0)");s=t.head;r=s[dt][Dt];s[dt][Dt]=n;n=e.css(s,Dt);s[dt][Dt]=r}if(n[Ut](/^rgb/gi)){o=n[Ut](/\d+/gi);n[Ut](/%/gi)&&(u=2.55);o[0]*=u;o[1]*=u;o[2]*=u;o[3]!==a?o[3]=i(o[3]):o[3]=1}return o}function Yn(e){var t=3,n;if(ln(e[Bt])!=="array"){e[Bt]=Gn(e[Bt]);e.end=Gn(e.end)}e.now=[];if(e[Bt][3]!==1||e.end[3]!==1)t=4;for(n=0;n<t;n+=1){e.now[n]=e[Bt][n]+(e.end[n]-e[Bt][n])*e.pos;n<3&&(e.now[n]=hn(e.now[n]))}if(e[Bt][3]!==1||e.end[3]!==1)e.now="rgba("+e.now.join(",")+")";else{e.now[vt](0,3);e.now="rgb("+e.now.join(",")+")"}e.elem.nodeName?e.elem[dt][e.prop]=e.now:e.elem[e.prop]=e.now}function Zn(t){var n;for(n=0;n<t[f];n+=1)e.fx.step[t[n]]=Yn}function er(e){window.ontouchstart!==undefined&&gn[e]&&(e=gn[e]);return e}function tr(e){yn[e]&&(e=yn[e]);return e}function nr(e){Cn[D][e]=function(t,n){var r,i;e=er(e);i=n[Q];r=e===z||e===K?_:e;if(!n[D][r]){t.bind(r+".jCanvas",function(e){i.x=e[Kt];i.y=e.offsetY;i.type=r;i[Q]=e;t[B]({resetFire:s});e.preventDefault()});n[D][r]=s}}}function rr(e){var t;for(t=0;t<e[f];t+=1)nr(e[t])}function ir(e,t,n){var r,i,o,a,f,l,c,h;r=n._args;if(r[m]){i=qn(e);o=i[Q];if(o.x!==u&&o.y!==u){l=o.x*i[Rt];c=o.y*i[Rt];a=t.isPointInPath(l,c)||t[$t]&&t[$t](l,c)}f=i[d];r.eventX=r.mouseX=o.x;r.eventY=r.mouseY=o.y;r[Q]=o[Q];h=i[d][ot];l=r.eventX;c=r.eventY;if(h!==0){r[Z]=l*vn(-h)-c*dn(-h);r[et]=c*vn(-h)+l*dn(-h)}else{r[Z]=l;r[et]=c}r[Z]/=f[st];r[et]/=f[ut];!a&&r[Mt]&&!r[Et]&&(r[It]=s);a&&i[$].push(r);r[X]=a}}function sr(e,t){if(t.font)e.font=t.font;else{isNaN(Number(t[E]))||(t[E]+="px");e.font=t[Xt]+" "+t[E]+" "+t[Ht]}}function or(t,n,r,s){var o,u,a=/\b(\d*\.?\d*)\w\w\b/gi,c,p;if(wn.text===r.text&&wn.font===r.font&&wn[Xt]===r[Xt]&&wn[E]===r[E]&&wn[Ht]===r[Ht]&&wn[kt]===r[kt]&&wn[nt]===r[nt]){r[h]=wn[h];r[l]=wn[l]}else{r[h]=n[q](s[0])[h];for(c=1;c<s[f];c+=1){p=n[q](s[c])[h];p>r[h]&&(r[h]=p)}o=t[dt][E];if(r.font){u=r.font[Ut](a);u&&(t[dt][E]=r.font[Ut](a)[0])}else t[dt][E]=r[E];r[l]=i(e.css(t,E))*s[f]*r[nt];t[dt][E]=o}}function ur(e,t){var n=t.text,r=t[kt],i=n.split(" "),s,o=[],u="";if(e[q](n)[h]<r||i[f]===1)o=[n];else{for(s=0;s<i[f];s+=1){if(e[q](u+i[s])[h]>r){u!==""&&o.push(u);u=""}u+=i[s];s!==i[f]-1&&(u+=" ")}o.push(u)}o=o.join("\n").replace(/( (\n))|( $)/gi,"$2").split("\n");return o}var f="length",l="height",c="layer",h="width",p="transparent",d="transforms",v="shadowColor",m="_event",g="splice",y="call",b="fillStyle",w="beginPath",E="fontSize",S="translate",x="getLayers",T="strokeStyle",N="getLayerGroup",C="visible",k="getLayer",L="dragGroupWithLayer",A="getContext",O="savedTransforms",M="sHeight",_="mousemove",D="events",P="_method",H="index",B="drawLayers",j="translateY",F="translateX",I="group",q="measureText",R="mousedown",U="closePath",z="mouseover",W="sWidth",X="intersects",V="drawImage",$="intersecting",J="_toRad",K="mouseout",Q="event",G="animating",Y="mouseup",Z="_eventX",et="_eventY",tt="name",nt="lineHeight",rt="touchstart",it="jCanvas",st="scaleX",ot="rotate",ut="scaleY",at="restore",ft="touchmove",lt="groups",ct="lineTo",ht="bezierCurveTo",pt="strokeWidth",dt="style",vt="slice",mt="autosave",gt="touchend",yt="shadowBlur",bt="closed",wt="dragstart",Et="_fired",St="concavity",xt="cursor",Tt="_startX",Nt="inDegrees",Ct="_startY",kt="maxWidth",Lt="dragging",At="radius",Ot="animated",Mt="_hovered",_t="dragstop",Dt="color",Pt="imageSmoothing",Ht="fontFamily",Bt="start",jt="_animating",Ft="drawArc",It="_mousedout",qt="hasOwnProperty",Rt="pixelRatio",Ut="match",zt="drawQuadratic",Wt="<canvas />",Xt="fontStyle",Vt="moveTo",$t="isPointInStroke",Jt="_masks",Kt="offsetX",Qt="draggable",Gt="drawPolygon",Yt="drawEllipse",Zt="load",en="drawBezier",tn="drawVector",nn="complete",rn="createPattern",sn="setLayer",on="restoreCanvas",un,an=e.extend,fn=e.inArray,ln=e.type,cn=e.isFunction,hn=r.round,pn=r.PI,dn=r.sin,vn=r.cos,mn=e[Q].fix,gn,yn,bn,wn={},En={},Sn={rotate:0,scaleX:1,scaleY:1,translateX:0,translateY:0,masks:[]},xn,Tn;e.fn[it]=Cn;Cn[D]={};un={align:"center",autosave:s,baseline:"middle",bringToFront:o,ccw:o,closed:o,compositing:"source-over",concavity:0,cornerRadius:0,count:1,cropFromCenter:s,disableDrag:o,disableEvents:o,domain:u,draggable:o,group:u,data:{},each:u,end:360,fillStyle:p,font:"",fontStyle:"normal",fontSize:"12pt",fontFamily:"sans-serif",fromCenter:s,fn:u,graph:"y",height:u,imageSmoothing:s,inDegrees:s,lineHeight:1,layer:o,load:u,mask:o,maxWidth:u,miterLimit:10,name:u,opacity:1,projection:0,r1:u,r2:u,radius:0,range:u,repeat:"repeat",respectAlign:o,rotate:0,rounded:o,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:p,shadowStroke:!1,shadowX:0,shadowY:0,sHeight:u,sides:0,source:"",start:0,strokeCap:"butt",strokeJoin:"miter",strokeStyle:p,strokeWidth:1,sWidth:u,sx:u,sy:u,text:"",translate:0,translateX:0,translateY:0,type:u,visible:s,width:u,x:0,y:0};Cn();Cn.extend=function(n){Cn.defaults=an(un,n.props);Cn();n[tt]&&(e.fn[n[tt]]=function r(e){var t=this,i,s,o,u=new Nn(e);for(s=0;s<t[f];s+=1){i=t[s];o=Ln(i);if(o){e=$n(i,u,e,r);_n(i,o,u);n.fn[y](i,o,u)}}return t});return e.fn[n[tt]]};e.fn[x]=function(t){var n=this[0],r,i,s=[];if(n&&n[A]){r=qn(n).layers;if(cn(t))for(i=0;i<r[f];i+=1)t[y](n,r[i])&&s.push(r[i]);else s=r}return s};e.fn[k]=function(t){var n=this[x](),r=ln(t),i=qn(this[0]),s,o;if(t&&t[c])s=t;else if(r==="number"){t<0&&(t=n[f]+t);s=n[t]}else if(r==="regexp"){for(o=0;o<n[f];o+=1)if(kn(n[o][tt])&&n[o][tt][Ut](t)){s=n[o];break}}else{i=qn(this[0]);s=i[c].names[t]}return s};e.fn[N]=function(t){var n=ln(t),r,i,s,o;if(n==="array")return t;if(n==="regexp"){o=qn(this[0]);r=o[lt];for(i in r)if(i[Ut](t)){s=r[i];break}}else{o=qn(this[0]);s=o[c][lt][t]}return s};e.fn.getLayerIndex=function(t){var n=this[x](),r=this[k](t);return fn(r,n)};e.fn[sn]=function(n,r){var i=this,s,o,u,a;for(o=0;o<i[f];o+=1){s=e(i[o]);u=qn(i[o]);a=e(i[o])[k](n);if(a){Wn(s,u,a,r);Xn(s,u,a,r);an(a,r);Rn(s,u,a);zn(s,u,a)}}return i};e.fn.setLayerGroup=function(n,r){var i=this,s,o,u,a;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[N](n);if(u)for(a=0;a<u[f];a+=1)s[sn](u[a],r)}return i};e.fn.setLayers=function(n){var r=this,i,s,o,u;for(s=0;s<r[f];s+=1){i=e(r[s]);o=e(r[s])[x]();for(u=0;u<o[f];u+=1)i[sn](o[u],n)}return r};e.fn.moveLayer=function(n,r){var i=this,s,o,u,a;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[x]();a=s[k](n);if(a){a[H]=fn(a,u);u[g](a[H],1);u[g](r,0,a);r<0&&(r=u[f]+r);a[H]=r}}return i};e.fn.removeLayer=function(n){var r=this,i,s,o,a,l;for(s=0;s<r[f];s+=1){i=e(r[s]);o=qn(r[s]);a=i[x]();l=i[k](n);if(l){l[H]=fn(l,a);a[g](l[H],1);Wn(i,o,l,{name:u});Xn(i,o,l,{group:u})}}return r};e.fn.removeLayerGroup=function(n){var r=this,i,s,o,l,h,p,d;if(n!==a)for(s=0;s<r[f];s+=1){i=e(r[s]);o=qn(r[s]);l=i[x]();h=i[N](n);if(h){for(d=0;d<h[f];d+=1){p=h[d];p[H]=fn(p,l);l[g](p[H],1);Wn(i,o,p,{name:u})}delete o[c][lt][h[tt]]}}return r};e.fn.removeLayers=function(){var n=this,r,i,s;for(i=0;i<n[f];i+=1){r=e(n[i]);s=qn(n[i]);s.layers[f]=0;s[c].names={};s[c][lt]={}}return n};e.fn.drawLayer=function(n){var r=this,i,s,o,u;for(i=0;i<r[f];i+=1){o=e(r[i]);s=Ln(r[i]);u=o[k](n);Vn(o,s,u)}return r};e.fn[B]=function(n){var r=this,i,a,l,h=an({},n),p,v,b,w,E,S,x,T,N,k,A,M;h[H]||(h[H]=0);for(a=0;a<r[f];a+=1){i=e(r[a]);l=Ln(r[a]);if(l){x=qn(r[a]);h.clear!==o&&i.clearCanvas();p=x.layers;for(b=h[H];b<p[f];b+=1){v=p[b];v[H]=b;h.resetFire&&(v[Et]=o);v[m]=!v.disableEvents;Vn(i,l,v,b+1);v[Jt]=x[d].masks[vt](0);if(v[It]){v[It]=o;v[Et]=s;v[Mt]=o;v[K]&&v[K][y](r[a],v);v[xt]&&v._cursor&&i.css({cursor:v._cursor})}if(v[P]===e.fn[V]&&v[C])break}w=b;v={};for(E=x[$][f]-1;E>=0;E-=1){v=x[$][E];if(v[Jt]){for(S=v[Jt][f]-1;S>=0;S-=1)if(!v[Jt][S][X]){v[X]=o;break}if(v[X])break}}T=x[Q];N=T.type;v[N]||(N=tr(N));M=v[N];k=x.drag;if(v[m]&&v[X]){if(v[z]||v[K]||v[xt])if(!v[Mt]&&!v[Et]){v[Et]=s;v[Mt]=s;v[z]&&v[z][y](r[a],v);if(v[xt]){v._cursor=i.css(xt);i.css({cursor:v[xt]})}}if(M&&!v[Et]){v[Et]=s;T.type=u;M[y](r[a],v)}v[Qt]&&!v.disableDrag&&(N===R||N===rt)&&(k[c]=v)}if(k[c])if(N===_||N===ft){if(!k[Lt]){k[Lt]=s;if(k[c].bringToFront){p[g](k[c][H],1);k[c][H]=p.push(k[c])}A=x[c][lt][k[c][I]];if(k[c][I]&&k[c][L]&&A)for(b=0;b<A[f];b+=1)if(A[b]!==k[c]){A[b][Tt]=A[b].x;A[b][Ct]=A[b].y;A[b]._endX=k[c][Z];A[b]._endY=k[c][et];if(A[b].bringToFront){A[b][H]=fn(A[b],p);p[g](A[b][H],1);p[g](-1,0,A[b]);A[b][H]=p[f]-2}A[b][wt]&&A[b][wt][y](r[a],A[b])}k[Tt]=k[c][Tt]=k[c].x;k[Ct]=k[c][Ct]=k[c].y;k._endX=k[c]._endX=k[c][Z];k._endY=k[c]._endY=k[c][et];k[c][wt]&&k[c][wt][y](i[0],k[c])}k[c].x=k[c][Z]-(k._endX-k[Tt]);k[c].y=k[c][et]-(k._endY-k[Ct]);A=x[c][lt][k[c][I]];if(k[c][I]&&k[c][L]&&A)for(b=0;b<A[f];b+=1)if(A[b]!==k[c]){A[b].x=k[c][Z]-(A[b]._endX-A[b][Tt]);A[b].y=k[c][et]-(A[b]._endY-A[b][Ct]);A[b].drag&&A[b].drag[y](r[a],A[b])}k[c].drag&&k[c].drag[y](r[a],k[c])}else if(N===Y||N===gt){if(k[c][_t]&&k[Lt]){k[c][_t][y](r[a],k[c]);k[Lt]=o}A=x[c][lt][k[c][I]];if(k[c][I]&&k[c][L]&&A)for(b=0;b<A[f];b+=1)A[b]!==k[c]&&A[b][_t]&&A[b][_t][y](r[a],A[b]);x.drag={}}if(w===p[f]){x[$][f]=0;x[d]=An(Sn);x[O][f]=0}}}return r};e.fn.addLayer=function(t){var n=this,r,i,o=new Nn(t);for(r=0;r<n[f];r+=1){i=Ln(n[r]);if(i){o[c]=s;t=$n(n[r],o,t)}}return n};xn=[h,l,"opacity",nt];Tn={};e.fn.animateLayer=function(){function v(e,t,n){return function(){Jn(n);(!t[G]||t[Ot]===n)&&e[B]();c[4]&&c[4][y](e[0],n);n[jt]=o;t[G]=o;t[Ot]=u}}function m(e,t,n){return function(r,i){Jn(n);if(!n[jt]&&!t[G]){n[jt]=s;t[G]=s;t[Ot]=n}(!t[G]||t[Ot]===n)&&e[B]();c[5]&&c[5][y](e[0],r,i,n)}}var n=this,r,i,l,c=[][vt][y](arguments,0),h,p,d;if(ln(c[2])==="object"){c[g](2,0,c[2].duration||u);c[g](3,0,c[3].easing||u);c[g](4,0,c[4][nn]||u);c[g](5,0,c[5].step||u)}else{if(c[2]===a){c[g](2,0,u);c[g](3,0,u);c[g](4,0,u)}else if(cn(c[2])){c[g](2,0,u);c[g](3,0,u)}if(c[3]===a){c[3]=u;c[g](4,0,u)}else cn(c[3])&&c[g](3,0,u)}for(i=0;i<n[f];i+=1){r=e(n[i]);l=Ln(n[i]);if(l){h=qn(n[i]);p=r[k](c[0]);if(p&&p[P]!==e.fn.draw){d=an({},c[1]);d=Qn(n[i],p,d);Kn(d,s);Kn(p);p[dt]=Tn;e(p).animate(d,{duration:c[2],easing:e.easing[c[3]]?c[3]:u,complete:v(r,h,p),step:m(r,h,p)})}}}return n};e.fn.animateLayerGroup=function(n){var r=this,i,s,o=[][vt][y](arguments,0),u,a;for(s=0;s<r[f];s+=1){i=e(r[s]);u=i[N](n);for(a=0;a<u[f];a+=1)i.animateLayer.apply(i,[u[a]].concat(o[vt](1)))}return r};e.fn.delayLayer=function(n,r){var i=this,s,o;r=r||0;for(s=0;s<i[f];s+=1){o=e(i[s])[k](n);e(o).delay(r)}return i};e.fn.delayLayerGroup=function(n,r){var i=this,s,o,u,a,l;r=r||0;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[N](n);if(u)for(l=0;l<u[f];l+=1){a=u[l];a&&e(a).delay(r)}}return i};e.fn.stopLayer=function(n,r){var i=this,s,o,u;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[k](n);u&&e(u).stop(r)}return i};e.fn.stopLayerGroup=function(n,r){var i=this,s,o,u,a,l;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[N](n);if(u)for(l=0;l<u[f];l+=1){a=u[l];a&&e(a).stop(r)}}return i};Zn([Dt,"backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor",b,"outlineColor",T,v]);gn={mousedown:rt,mouseup:gt,mousemove:ft};yn={touchstart:R,touchend:Y,touchmove:_};rr(["click","dblclick",R,Y,_,z,K,rt,ft,gt]);e[Q].fix=function(t){var n,r,i;t=mn[y](e[Q],t);r=t.originalEvent;if(r){i=r.changedTouches;if(t.pageX!==a&&t[Kt]===a){n=e(t.target).offset();if(n){t[Kt]=t.pageX-n.left;t.offsetY=t.pageY-n.top}}else if(i){n=e(r.target).offset();if(n){t[Kt]=i[0].pageX-n.left;t.offsetY=i[0].pageY-n.top}}}return t};bn={arc:Ft,bezier:en,circle:Ft,ellipse:Yt,"function":"draw",image:V,line:"drawLine",polygon:Gt,quadratic:zt,rectangle:"drawRect",text:"drawText",vector:tn};e.fn.draw=function ar(t){var n=this,r,i,s,o;o=new Nn(t);for(i=0;i<n[f];i+=1){r=e(n[i]);s=Ln(n[i]);if(s){t=$n(n[i],o,t,ar);o[C]&&(o.fn?o.fn[y](n[i],s,o):o[P]!==ar&&o[P][y](r,t))}}return n};e.fn.clearCanvas=function(t){var n=this,r,i,s=new Nn(t);for(r=0;r<n[f];r+=1){i=Ln(n[r]);if(i)if(s[h]===u||s[l]===u){i.save();i.setTransform(1,0,0,1,0,0);i.clearRect(0,0,n[r][h],n[r][l]);i[at]()}else{In(i,s,s[h],s[l]);i.clearRect(s.x-s[h]/2,s.y-s[l]/2,s[h],s[l]);i[at]()}}return n};e.fn.saveCanvas=function fr(e){var t=this,n,r,i=new Nn(e),s,o;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){s=qn(t[n]);e=$n(t[n],i,e,fr);for(o=0;o<i.count;o+=1)On(r,s)}}return t};e.fn[on]=function lr(e){var t=this,n,r,i=new Nn(e),s,o;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){s=qn(t[n]);e=$n(t[n],i,e,lr);for(o=0;o<i.count;o+=1)Mn(r,s)}}return t};e.fn.restoreCanvasOnRedraw=function(t){var n=this,r=an({},t);r[c]=s;n[on](r);return n};e.fn.rotateCanvas=function cr(e){var t=this,n,r,i=new Nn(e),s;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){s=qn(t[n]);e=$n(t[n],i,e,cr);i[mt]&&On(r,s);Bn(r,i,s[d])}}return t};e.fn.scaleCanvas=function hr(e){var t=this,n,r,i=new Nn(e),s;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){s=qn(t[n]);e=$n(t[n],i,e,hr);i[mt]&&On(r,s);jn(r,i,s[d])}}return t};e.fn.translateCanvas=function pr(e){var t=this,n,r,i=new Nn(e),s;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){s=qn(t[n]);e=$n(t[n],i,e,pr);i[mt]&&On(r,s);Fn(r,i,s[d])}}return t};e.fn.drawRect=function dr(e){var t=this,n,r,i=new Nn(e),u,a,c,p,d;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){e=$n(t[n],i,e,dr);if(i[C]){_n(t[n],r,i);In(r,i,i[h],i[l]);r[w]();u=i.x-i[h]/2;a=i.y-i[l]/2;d=i.cornerRadius;if(d){i[bt]=s;c=i.x+i[h]/2;p=i.y+i[l]/2;c-u-2*d<0&&(d=(c-u)/2);p-a-2*d<0&&(d=(p-a)/2);r[Vt](u+d,a);r[ct](c-d,a);r.arc(c-d,a+d,d,3*pn/2,pn*2,o);r[ct](c,p-d);r.arc(c-d,p-d,d,0,pn/2,o);r[ct](u+d,p);r.arc(u+d,p-d,d,pn/2,pn,o);r[ct](u,a+d);r.arc(u+d,a+d,d,pn,3*pn/2,o)}else r.rect(u,a,i[h],i[l]);i[m]&&ir(t[n],r,i);Hn(t[n],r,i)}}}return t};e.fn[Ft]=function vr(e){var t=this,n,r,i=new Nn(e);e=e||{};i[c]&&!i[Nt]&&i.end===360&&(e.end=i.end=pn*2);for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){e=$n(t[n],i,e,vr);if(i[C]){_n(t[n],r,i);In(r,i,i[At]*2);r[w]();r.arc(i.x,i.y,i[At],i[Bt]*i[J]-pn/2,i.end*i[J]-pn/2,i.ccw);i[m]&&ir(t[n],r,i);Hn(t[n],r,i)}}}return t};e.fn[Yt]=function mr(e){var t=this,n,r,i=new Nn(e),o=i[h]*(4/3),u=i[l];i[bt]=s;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){e=$n(t[n],i,e,mr);if(i[C]){_n(t[n],r,i);In(r,i,i[h],i[l]);r[w]();r[Vt](i.x,i.y-u/2);r[ht](i.x-o/2,i.y-u/2,i.x-o/2,i.y+u/2,i.x,i.y+u/2);r[ht](i.x+o/2,i.y+u/2,i.x+o/2,i.y-u/2,i.x,i.y-u/2);i[m]&&ir(t[n],r,i);Hn(t[n],r,i)}}}return t};e.fn[Gt]=function gr(e){var t=this,n,r,i=new Nn(e),o=2*pn/i.sides,u=o/2,a=u+pn/2,l=i[At]*vn(u),c,h,p;i.projection&&(i[St]=-i.projection);for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){e=$n(t[n],i,e,gr);if(i[C]){_n(t[n],r,i);In(r,i,i[At]*2);r[w]();for(p=0;p<i.sides;p+=1){c=i.x+i[At]*vn(a);h=i.y+i[At]*dn(a);r[ct](c,h);if(i[St]){c=i.x+(l+ -l*i[St])*vn(a+u);h=i.y+(l+ -l*i[St])*dn(a+u);r[ct](c,h)}a+=o}i[m]&&ir(t[n],r,i);i[bt]=s;Hn(t[n],r,i)}}}return t};e.fn.drawLine=function yr(e){var t=this,n,r,i=new Nn(e),o,u,l;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){e=$n(t[n],i,e,yr);if(i[C]){_n(t[n],r,i);In(r,i,0);o=1;r[w]();while(s){u=i["x"+o];l=i["y"+o];if(u===a||l===a)break;r[ct](u+i.x,l+i.y);o+=1}i[m]&&ir(t[n],r,i);Hn(t[n],r,i)}}}return t};e.fn[zt]=e.fn.drawQuad=function br(e){var t=this,n,r,i=new Nn(e),o,u,l,c,h;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){e=$n(t[n],i,e,br);if(i[C]){_n(t[n],r,i);In(r,i,0);o=2;r[w]();r[Vt](i.x1+i.x,i.y1+i.y);while(s){u=i["x"+o];l=i["y"+o];c=i["cx"+(o-1)];h=i["cy"+(o-1)];if(u===a||l===a||c===a||h===a)break;r.quadraticCurveTo(c+i.x,h+i.y,u+i.x,l+i.y);o+=1}i[m]&&ir(t[n],r,i);Hn(t[n],r,i)}}}return t};e.fn[en]=function wr(e){var t=this,n,r,i=new Nn(e),o,u,l,c,h,p,d,v;for(n=0;n<t[f];n+=1){r=Ln(t[n]);if(r){e=$n(t[n],i,e,wr);if(i[C]){_n(t[n],r,i);In(r,i,0);o=2;u=1;r[w]();r[Vt](i.x1+i.x,i.y1+i.y);while(s){l=i["x"+o];c=i["y"+o];h=i["cx"+u];p=i["cy"+u];d=i["cx"+(u+1)];v=i["cy"+(u+1)];if(l===a||c===a||h===a||p===a||d===a||v===a)break;r[ht](h+i.x,p+i.y,d+i.x,v+i.y,l+i.x,c+i.y);o+=1;u+=2}i[m]&&ir(t[n],r,i);Hn(t[n],r,i)}}}return t};e.fn[tn]=function Er(e){var t=this,n,i,o=new Nn(e),u,l,c,h,p;for(n=0;n<t[f];n+=1){i=Ln(t[n]);if(i){e=$n(t[n],o,e,Er);if(o[C]){_n(t[n],i,o);In(i,o,0);u=1;i[w]();h=o.x;p=o.y;i[Vt](o.x,o.y);while(s){l=o["a"+u];c=o["l"+u];if(l===a||c===a)break;l=l*o[J]-pn/2;h+=c*r.cos(l);p+=c*r.sin(l);i[ct](h,p);u+=1}o[m]&&ir(t[n],i,o);Hn(t[n],i,o)}}}return t};e.fn.drawText=function Sr(t){var n=this,r,i,s,o=new Nn(t),a,d,g,y;for(i=0;i<n[f];i+=1){r=e(n[i]);s=Ln(n[i]);if(s){t=$n(n[i],o,t,Sr);if(o[C]){_n(n[i],s,o);s.textBaseline=o.baseline;s.textAlign=o.align;sr(s,o);!i&&o[kt]!==u?a=ur(s,o):i||(a=String(o.text).split("\n"));if(!i){or(n[i],s,o,a);if(t&&o[c]){t[h]=o[h];t[l]=o[l]}g=o.x;o.align==="left"?o.respectAlign?o.x+=o[h]/2:g-=o[h]/2:o.align==="right"&&(o.respectAlign?o.x-=o[h]/2:g+=o[h]/2)}In(s,o,o[h],o[l]);for(d=0;d<a[f];d+=1){s[v]=o[v];y=o.y+d*o[l]/a[f]-(a[f]-1)*o[l]/a[f]/2;s.fillText(a[d],g,y);o[b]!==p&&(s[v]=p);s.strokeText(a[d],g,y)}if(o[m]){s[w]();s.rect(o.x-o[h]/2,o.y-o[l]/2,o[h],o[l]);ir(n[i],s,o);s[U]()}Pn(s,o)}}}wn=o;return n};e.fn[q]=function xr(e){var t=this,n,r,i;e===a||ln(e)==="object"&&!e[c]?r=new Nn(e):r=t[k](e);n=Ln(t[0]);if(n){sr(n,r);i=ur(n,r);xr(t[0],n,r,i)}return r};e.fn[V]=function Tr(t){function T(e,n,i){if(e===0){b[h]===u&&b[W]===u&&(b[h]=b[W]=E[h]);b[l]===u&&b[M]===u&&(b[l]=b[M]=E[l]);if(t&&b[c]){t[h]=b[h];t[l]=b[l]}}if(b[W]!==u&&b[M]!==u&&b.sx!==u&&b.sy!==u){if(e===0){b[h]===u&&(b[h]=b[W]);b[l]===u&&(b[l]=b[M]);if(!b.cropFromCenter){b.sx+=b[W]/2;b.sy+=b[M]/2}b.sx+b[W]/2>E[h]&&(b.sx=E[h]-b[W]/2);b.sx-b[W]/2<0&&(b.sx=b[W]/2);b.sy-b[M]/2<0&&(b.sy=b[M]/2);b.sy+b[M]/2>E[l]&&(b.sy=E[l]-b[M]/2)}In(n,b,b[h],b[l]);n[V](E,b.sx-b[W]/2,b.sy-b[M]/2,b[W],b[M],b.x-b[h]/2,b.y-b[l]/2,b[h],b[l])}else{In(n,b,b[h],b[l]);n[V](E,b.x-b[h]/2,b.y-b[l]/2,b[h],b[l])}_n(r[e],n,b);n[w]();n.rect(b.x-b[h]/2,b.y-b[l]/2,b[h],b[l]);b[m]&&ir(r[e],n,b);n[U]();n.stroke();Pn(n,b);Dn(n,i,b)}function N(n,r,i,u){return function(){T(r,i,u);b[Zt]&&b[Zt][y](n,t);if(b[c]){b._args[Jt]=u[d].masks[vt](0);b._next&&e(n)[B]({clear:o,resetFire:s,index:b._next})}}}var r=this,i,p,v,g,b=new Nn(t),E,S,x;x=b.source;S=x[A];if(x.src||S)E=x;else if(x)if(En[x]!==a)E=En[x];else{E=new n;E.src=x;En[x]=E}for(p=0;p<r[f];p+=1){i=r[p];v=Ln(r[p]);if(v){g=qn(r[p]);t=$n(r[p],b,t,Tr);if(b[C]&&E)if(E[nn]||S)N(i,p,v,g)();else{e(E).bind(Zt,N(i,p,v,g));E.src=E.src}}}return r};e.fn[rn]=e.fn.pattern=function(r){function d(){f=s[rn](a,o.repeat);o[Zt]&&o[Zt][y](i[0],f)}var i=this,s,o=new Nn(r),a,f,c,p;s=Ln(i[0]);if(s){p=o.source;if(cn(p)){a=e(Wt)[0];a[h]=o[h];a[l]=o[l];c=Ln(a);p[y](a,c);d()}else{c=p[A];if(p.src||c)a=p;else{a=new n;a.src=p}if(a[nn]||c)d();else{e(a).bind(Zt,d);a.src=a.src}}}else f=u;return f};e.fn.createGradient=e.fn.gradient=function(t){var n=this,r,i=new Nn(t),s,o=[],l,c,h,p,d,v,m;r=Ln(n[0]);if(r){i.x1=i.x1||0;i.y1=i.y1||0;i.x2=i.x2||0;i.y2=i.y2||0;i.r1!==u||i.r2!==u?s=r.createRadialGradient(i.x1,i.y1,i.r1,i.x2,i.y2,i.r2):s=r.createLinearGradient(i.x1,i.y1,i.x2,i.y2);for(p=1;i["c"+p]!==a;p+=1)i["s"+p]!==a?o.push(i["s"+p]):o.push(u);l=o[f];o[0]===u&&(o[0]=0);o[l-1]===u&&(o[l-1]=1);for(p=0;p<l;p+=1){if(o[p]!==u){v=1;m=0;c=o[p];for(d=p+1;d<l;d+=1){if(o[d]!==u){h=o[d];break}v+=1}c>h&&(o[d]=o[p])}else if(o[p]===u){m+=1;o[p]=c+m*((h-c)/v)}s.addColorStop(o[p],i["c"+(p+1)])}}else s=u;return s};e.fn.setPixels=function Nr(e){var t=this,n,r,i,s=new Nn(e),o={},a,c,p,d;for(r=0;r<t[f];r+=1){n=t[r];i=Ln(n);if(i){e=$n(n,s,e,Nr);In(i,s,s[h],s[l]);if(s[h]===u||s[l]===u){s[h]=n[h];s[l]=n[l];s.x=s[h]/2;s.y=s[l]/2}if(s[h]!==0&&s[l]!==0){a=i.getImageData(s.x-s[h]/2,s.y-s[l]/2,s[h],s[l]);c=a.data;d=c[f];o=[];if(s.each)for(p=0;p<d;p+=4){o.r=c[p];o.g=c[p+1];o.b=c[p+2];o.a=c[p+3];s.each[y](n,o);c[p]=o.r;c[p+1]=o.g;c[p+2]=o.b;c[p+3]=o.a}i.putImageData(a,s.x-s[h]/2,s.y-s[l]/2);i[at]()}}}return t};e.fn.getCanvasImage=function(t,n){var r=this[0];n===a&&(n=1);return r&&r.toDataURL?r.toDataURL("image/"+t,n):u};e.fn.detectPixelRatio=function(n){var r=this,i,o,u,a,c,p,d,v,m,g;for(u=0;u<r[f];u+=1){o=r[u];i=e(r[u]);a=Ln(o);g=qn(r[u]);if(!g.scaled){c=window.devicePixelRatio||1;p=a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1;d=c/p;if(d!==1){v=o[h];m=o[l];o[h]=v*d;o[l]=m*d;o[dt][h]=v+"px";o[dt][l]=m+"px";a.scale(d,d)}g[Rt]=d;g.scaled=s;n&&n[y](o,d)}}return r};e.support.canvas=e(Wt)[0][A]!==a;Cn.defaults=un;Cn.detectEvents=ir;Cn[U]=Hn;Cn.getTouchEventName=er;e[it]=Cn})(jQuery,document,Image,Math,parseFloat,!0,!1,null);